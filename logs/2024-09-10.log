2024-09-10 21:59:39 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-09-10 21:59:39 - INFO - Successfully fetched 124999 customer IDs.
2024-09-10 21:59:39 - INFO - Starting scenario data retrieval.
2024-09-10 21:59:39 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-10 21:59:39 - INFO - Fetching scenario configuration data
2024-09-10 21:59:43 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_01')
        
2024-09-10 21:59:43 - INFO - Starting threshold data retrieval.
2024-09-10 21:59:43 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-10 21:59:43 - INFO - SQLQueryExecutor initialized successfully.
2024-09-10 21:59:43 - INFO - Fetching threshold configuration data.
2024-09-10 21:59:43 - DEBUG - Processing scenario ID: TS_SCN_01
2024-09-10 21:59:43 - DEBUG - Executing SQL query for scenario ID TS_SCN_01: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-09-10 21:59:48 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-09-10 21:59:48 - INFO - Threshold data fetching completed successfully.
2024-09-10 21:59:48 - INFO - Starting customer ID processing.
2024-09-10 21:59:48 - INFO - Initializing Spark session with JDBC configurations.
2024-09-10 21:59:51 - INFO - Spark session initialized successfully.
2024-09-10 21:59:51 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 21:59:51 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 21:59:51 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 21:59:51 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:04 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_2.parquet
2024-09-10 22:00:04 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_1.parquet
2024-09-10 22:00:04 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_0.parquet
2024-09-10 22:00:04 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_3.parquet
2024-09-10 22:00:04 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:04 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:04 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:04 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:10 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_4.parquet
2024-09-10 22:00:10 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:10 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_6.parquet
2024-09-10 22:00:10 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:10 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_7.parquet
2024-09-10 22:00:10 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:11 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_5.parquet
2024-09-10 22:00:11 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:19 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_8.parquet
2024-09-10 22:00:19 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:19 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_11.parquet
2024-09-10 22:00:19 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:19 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_9.parquet
2024-09-10 22:00:19 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:19 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_10.parquet
2024-09-10 22:00:19 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:24 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_13.parquet
2024-09-10 22:00:25 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:25 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_12.parquet
2024-09-10 22:00:25 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:26 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_14.parquet
2024-09-10 22:00:26 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:26 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_15.parquet
2024-09-10 22:00:26 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:33 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_16.parquet
2024-09-10 22:00:33 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:33 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_17.parquet
2024-09-10 22:00:33 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:34 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_19.parquet
2024-09-10 22:00:34 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:34 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_18.parquet
2024-09-10 22:00:34 - INFO - Fetching transaction data for 5000 customers.
2024-09-10 22:00:39 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_20.parquet
2024-09-10 22:00:39 - INFO - Fetching transaction data for 4999 customers.
2024-09-10 22:00:39 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_21.parquet
2024-09-10 22:00:41 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_23.parquet
2024-09-10 22:00:43 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_22.parquet
2024-09-10 22:00:46 - INFO - Data saved to Parquet file: /home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/Parquet_Data/157/trxn_data_chunk_24.parquet
2024-09-10 22:00:46 - INFO - All customer chunks processed.
2024-09-10 22:00:47 - INFO - Spark session stopped.
2024-09-10 22:00:47 - INFO - Starting Parquet files processing.
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-09-10 22:00:47 - INFO - Read 470 rows from Parquet_Data/157/trxn_data_chunk_0.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-09-10 22:00:47 - INFO - Read 446 rows from Parquet_Data/157/trxn_data_chunk_1.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_10.parquet
2024-09-10 22:00:47 - INFO - Read 441 rows from Parquet_Data/157/trxn_data_chunk_10.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_10.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_11.parquet
2024-09-10 22:00:47 - INFO - Read 455 rows from Parquet_Data/157/trxn_data_chunk_11.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_11.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_12.parquet
2024-09-10 22:00:47 - INFO - Read 472 rows from Parquet_Data/157/trxn_data_chunk_12.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_12.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_13.parquet
2024-09-10 22:00:47 - INFO - Read 434 rows from Parquet_Data/157/trxn_data_chunk_13.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_13.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_14.parquet
2024-09-10 22:00:47 - INFO - Read 444 rows from Parquet_Data/157/trxn_data_chunk_14.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_14.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_15.parquet
2024-09-10 22:00:47 - INFO - Read 452 rows from Parquet_Data/157/trxn_data_chunk_15.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_15.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_16.parquet
2024-09-10 22:00:47 - INFO - Read 423 rows from Parquet_Data/157/trxn_data_chunk_16.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_16.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_17.parquet
2024-09-10 22:00:47 - INFO - Read 485 rows from Parquet_Data/157/trxn_data_chunk_17.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_17.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_18.parquet
2024-09-10 22:00:47 - INFO - Read 397 rows from Parquet_Data/157/trxn_data_chunk_18.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_18.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_19.parquet
2024-09-10 22:00:47 - INFO - Read 451 rows from Parquet_Data/157/trxn_data_chunk_19.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_19.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-09-10 22:00:47 - INFO - Read 424 rows from Parquet_Data/157/trxn_data_chunk_2.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_20.parquet
2024-09-10 22:00:47 - INFO - Read 450 rows from Parquet_Data/157/trxn_data_chunk_20.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_20.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_21.parquet
2024-09-10 22:00:47 - INFO - Read 421 rows from Parquet_Data/157/trxn_data_chunk_21.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_21.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_22.parquet
2024-09-10 22:00:47 - INFO - Read 476 rows from Parquet_Data/157/trxn_data_chunk_22.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_22.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_23.parquet
2024-09-10 22:00:47 - INFO - Read 419 rows from Parquet_Data/157/trxn_data_chunk_23.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_23.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_24.parquet
2024-09-10 22:00:47 - INFO - Read 440 rows from Parquet_Data/157/trxn_data_chunk_24.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_24.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-09-10 22:00:47 - INFO - Read 474 rows from Parquet_Data/157/trxn_data_chunk_3.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-09-10 22:00:47 - INFO - Read 453 rows from Parquet_Data/157/trxn_data_chunk_4.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-09-10 22:00:47 - INFO - Read 456 rows from Parquet_Data/157/trxn_data_chunk_5.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_6.parquet
2024-09-10 22:00:47 - INFO - Read 422 rows from Parquet_Data/157/trxn_data_chunk_6.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_6.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_7.parquet
2024-09-10 22:00:47 - INFO - Read 443 rows from Parquet_Data/157/trxn_data_chunk_7.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_7.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_8.parquet
2024-09-10 22:00:47 - INFO - Read 419 rows from Parquet_Data/157/trxn_data_chunk_8.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_8.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_9.parquet
2024-09-10 22:00:47 - INFO - Read 449 rows from Parquet_Data/157/trxn_data_chunk_9.parquet
2024-09-10 22:00:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - ALERTCHECKER initialized successfully.
2024-09-10 22:00:47 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-10 22:00:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-10 22:00:47 - INFO - No Alerts found!
2024-09-10 22:00:47 - INFO - Successfully processed data with ALERTCHECKER.
2024-09-10 22:00:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_9.parquet with scenario ID TS_SCN_01
2024-09-10 22:00:47 - INFO - Pipeline execution completed successfully.
2024-09-10 22:03:14 - INFO - Received request to start pipeline with details: {'job_id': 157, 'job_name': 'High Risk Geography (Customer)', 'scenario_ids': ['TS_SCN_01'], 'trigger_by': 'DS_TEAM'}
2024-09-10 22:03:14 - INFO - Starting customer ID retrieval.
2024-09-10 22:03:14 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-10 22:03:20 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-09-10 22:03:20 - INFO - Successfully fetched 125001 customer IDs.
2024-09-10 22:03:20 - INFO - Starting scenario data retrieval.
2024-09-10 22:03:20 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-10 22:03:20 - INFO - Fetching scenario configuration data
2024-09-10 22:03:24 - ERROR - Database connection error: (pyodbc.ProgrammingError) ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'THRESHOLD_LEVEL_FL'. (207) (SQLExecDirectW)")
[SQL: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_01')
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2024-09-10 22:03:24 - ERROR - SQLAlchemy Error executing SQL query - 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_01')
         | (pyodbc.ProgrammingError) ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'THRESHOLD_LEVEL_FL'. (207) (SQLExecDirectW)")
[SQL: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_01')
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2024-09-10 22:03:24 - ERROR - Error while fetching and processing scenario data: 'SCENARIO_ID'
2024-09-10 22:03:24 - ERROR - Pipeline execution failed: 'SCENARIO_ID'
Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/runner.py", line 50, in run_pipeline
    job_details = retrieve_scenario_data(received_request)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_fetcher/scenario_data_fetcher.py", line 61, in retrieve_scenario_data
    scenario_data.groupby('SCENARIO_ID')
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/groupby/groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/groupby/grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'SCENARIO_ID'

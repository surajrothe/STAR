2024-10-22 16:58:14 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 16:58:14 - INFO - Starting scenario data retrieval.
2024-10-22 16:58:14 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:14 - INFO - Fetching scenario configuration data
2024-10-22 16:58:19 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 16:58:21 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 16:58:21 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:21 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:32 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 16:58:32 - INFO - Starting customer ID retrieval.
2024-10-22 16:58:32 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:44 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 16:58:44 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 16:58:44 - INFO - Starting threshold data retrieval.
2024-10-22 16:58:44 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:44 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 16:58:44 - INFO - Fetching threshold configuration data.
2024-10-22 16:58:44 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 16:58:44 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 16:58:48 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 16:58:49 - INFO - Threshold data fetching completed successfully.
2024-10-22 16:58:49 - INFO - Starting customer ID processing.
2024-10-22 16:58:49 - INFO - Starting Parquet files processing.
2024-10-22 16:58:49 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 16:58:49 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 16:58:49 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 16:58:49 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:49 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 16:58:49 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 16:58:49 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 16:58:49 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 16:58:49 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 16:58:49 - INFO - No Alerts found!
2024-10-22 16:58:49 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 16:58:49 - INFO - No alerts generated!
2024-10-22 16:58:49 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 16:58:49 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 16:58:50 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 16:58:50 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:50 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 16:58:50 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 16:58:50 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 16:58:50 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 16:58:50 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 16:58:50 - INFO - No Alerts found!
2024-10-22 16:58:50 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 16:58:50 - INFO - No alerts generated!
2024-10-22 16:58:50 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 16:58:50 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 16:58:50 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 16:58:50 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:50 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 16:58:50 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 16:58:50 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 16:58:50 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 16:58:50 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 16:58:50 - INFO - No Alerts found!
2024-10-22 16:58:50 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 16:58:50 - INFO - No alerts generated!
2024-10-22 16:58:50 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 16:58:50 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 16:58:51 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 16:58:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:51 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 16:58:51 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 16:58:51 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 16:58:51 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 16:58:51 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 16:58:51 - INFO - No Alerts found!
2024-10-22 16:58:51 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 16:58:51 - INFO - No alerts generated!
2024-10-22 16:58:51 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 16:58:51 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 16:58:51 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 16:58:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:51 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 16:58:51 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 16:58:51 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 16:58:51 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 16:58:51 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 16:58:52 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 16:58:52 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 16:58:52 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 16:58:52 - INFO - Generated evidence report with 1 rows.
2024-10-22 16:58:52 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 16:58:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:57 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 16:58:57 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 16:58:57 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 16:58:57 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:58:57 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 16:59:02 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 16:59:08 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 16:59:08 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:59:12 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:59:18 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:59:28 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:59:34 - ERROR - Error occurred while mapping generated ALERT_ID with alert risk scoring data: name 'fetch_alert_id' is not defined
2024-10-22 16:59:34 - ERROR - Error while pushing alert data: name 'fetch_alert_id' is not defined
2024-10-22 16:59:34 - ERROR - Error processing data with ALERTCHECKER: name 'fetch_alert_id' is not defined
Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_scenarios/scenario_manager.py", line 115, in process_with_alert_checker
    alert_pusher.push_alerts(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 541, in push_alerts
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 531, in push_alerts
    self.push_alert_score_data(job_details, alert_id_mapping_dict, alert_table, ars_table)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 500, in push_alert_score_data
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 434, in push_alert_score_data
    self.push_auto_closure_narrative(narrative_data, alert_id_mapping_dict)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 262, in push_auto_closure_narrative
    inserted_data = self.sql_executor.execute_query(fetch_alert_id)
NameError: name 'fetch_alert_id' is not defined
2024-10-22 16:59:34 - ERROR - Error processing Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 16:59:34 - INFO - All data fetched: 915730 transactions | Total unique customers: 124753
2024-10-22 16:59:35 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 16:59:35 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 16:59:41 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 16:59:41 - INFO - Pipeline execution completed successfully.
2024-10-22 17:00:44 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:00:44 - INFO - Starting scenario data retrieval.
2024-10-22 17:00:44 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:00:44 - INFO - Fetching scenario configuration data
2024-10-22 17:00:50 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:00:51 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:00:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:00:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:02 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:01:02 - INFO - Starting customer ID retrieval.
2024-10-22 17:01:02 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:09 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:01:09 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:01:09 - INFO - Starting threshold data retrieval.
2024-10-22 17:01:09 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:09 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:01:09 - INFO - Fetching threshold configuration data.
2024-10-22 17:01:09 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:01:09 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:01:13 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:01:13 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:01:13 - INFO - Starting customer ID processing.
2024-10-22 17:01:13 - INFO - Starting Parquet files processing.
2024-10-22 17:01:13 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:01:13 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:01:13 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:01:13 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:13 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:01:13 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:01:13 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:01:13 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:01:13 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:01:14 - INFO - No Alerts found!
2024-10-22 17:01:14 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:01:14 - INFO - No alerts generated!
2024-10-22 17:01:14 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:01:14 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:01:14 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:01:14 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:14 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:01:14 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:01:14 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:01:14 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:01:14 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:01:14 - INFO - No Alerts found!
2024-10-22 17:01:14 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:01:14 - INFO - No alerts generated!
2024-10-22 17:01:14 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:01:14 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:01:14 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:01:14 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:14 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:01:14 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:01:14 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:01:14 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:01:14 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:01:15 - INFO - No Alerts found!
2024-10-22 17:01:15 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:01:15 - INFO - No alerts generated!
2024-10-22 17:01:15 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:01:15 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:01:15 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:01:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:15 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:01:15 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:01:15 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:01:15 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:01:15 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:01:15 - INFO - No Alerts found!
2024-10-22 17:01:15 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:01:15 - INFO - No alerts generated!
2024-10-22 17:01:15 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:01:15 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:01:16 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:01:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:16 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:01:16 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:01:16 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:01:16 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:01:16 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:01:16 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:01:16 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:01:16 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:01:16 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:01:16 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:01:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:20 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:01:20 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:01:20 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:01:20 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:20 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:01:25 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:01:31 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:01:32 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:36 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:44 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:01:54 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:02:01 - ERROR - Error inserting narrative for ALERT_ID 11393: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2024-10-22 17:02:01 - INFO - Narrative data successfully pushed to TS_ALERT_NARR.
2024-10-22 17:02:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:02:09 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:02:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:02:21 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:02:21 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-10-22 17:02:21 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-10-22 17:02:21 - ERROR - No data found for scenario ID TS_SCN_29 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-10-22 17:02:21 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-10-22 17:02:21 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:02:21 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:02:28 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:02:28 - INFO - Pipeline execution completed successfully.
2024-10-22 17:04:02 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:04:02 - INFO - Starting scenario data retrieval.
2024-10-22 17:04:02 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:04:02 - INFO - Fetching scenario configuration data
2024-10-22 17:04:07 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:04:08 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:04:08 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:04:08 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:04:17 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:04:17 - INFO - Starting customer ID retrieval.
2024-10-22 17:04:17 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:04:54 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:04:54 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:04:54 - INFO - Starting threshold data retrieval.
2024-10-22 17:04:54 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:04:54 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:04:54 - INFO - Fetching threshold configuration data.
2024-10-22 17:04:54 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:04:54 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:04:58 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:04:58 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:04:58 - INFO - Starting customer ID processing.
2024-10-22 17:04:58 - INFO - Starting Parquet files processing.
2024-10-22 17:04:58 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:04:58 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:04:59 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:04:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:04:59 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:04:59 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:04:59 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:04:59 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:04:59 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:04:59 - INFO - No Alerts found!
2024-10-22 17:04:59 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:04:59 - INFO - No alerts generated!
2024-10-22 17:04:59 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:04:59 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:04:59 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:04:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:04:59 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:04:59 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:04:59 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:04:59 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:04:59 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:05:00 - INFO - No Alerts found!
2024-10-22 17:05:00 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:05:00 - INFO - No alerts generated!
2024-10-22 17:05:00 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:05:00 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:05:00 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:05:00 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:00 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:05:00 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:05:00 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:05:00 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:05:00 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:05:00 - INFO - No Alerts found!
2024-10-22 17:05:00 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:05:00 - INFO - No alerts generated!
2024-10-22 17:05:00 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:05:00 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:05:01 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:05:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:01 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:05:01 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:05:01 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:05:01 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:05:01 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:05:01 - INFO - No Alerts found!
2024-10-22 17:05:01 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:05:01 - INFO - No alerts generated!
2024-10-22 17:05:01 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:05:01 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:05:01 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:05:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:01 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:05:01 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:05:01 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:05:01 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:05:01 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:05:01 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:05:01 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:05:01 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:05:01 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:05:01 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:05:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:05 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:05:05 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:05:05 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:05:05 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:05 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:05:11 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:05:17 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:05:17 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:21 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:27 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:39 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:46 - ERROR - ALERT_INVSTN_ID not found for ALERT_ID 11393, skipping...
2024-10-22 17:05:46 - INFO - Narrative data successfully pushed to TS_ALERT_NARR.
2024-10-22 17:05:46 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:05:54 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:06:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:06:07 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:06:07 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-10-22 17:06:07 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-10-22 17:06:07 - ERROR - No data found for scenario ID TS_SCN_29 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-10-22 17:06:07 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-10-22 17:06:07 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:06:07 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:06:13 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:06:13 - INFO - Pipeline execution completed successfully.
2024-10-22 17:12:57 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:12:57 - INFO - Starting scenario data retrieval.
2024-10-22 17:12:57 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:12:57 - INFO - Fetching scenario configuration data
2024-10-22 17:13:03 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:13:04 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:13:05 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:05 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:15 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:13:15 - INFO - Starting customer ID retrieval.
2024-10-22 17:13:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:22 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:13:22 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:13:22 - INFO - Starting threshold data retrieval.
2024-10-22 17:13:22 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:22 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:13:22 - INFO - Fetching threshold configuration data.
2024-10-22 17:13:22 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:13:22 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:13:25 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:13:26 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:13:26 - INFO - Starting customer ID processing.
2024-10-22 17:13:26 - INFO - Starting Parquet files processing.
2024-10-22 17:13:26 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:13:26 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:13:26 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:13:26 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:26 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:13:26 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:13:26 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:13:26 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:13:26 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:13:27 - INFO - No Alerts found!
2024-10-22 17:13:27 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:13:27 - INFO - No alerts generated!
2024-10-22 17:13:27 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:13:27 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:13:27 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:13:27 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:27 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:13:27 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:13:27 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:13:27 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:13:27 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:13:27 - INFO - No Alerts found!
2024-10-22 17:13:27 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:13:27 - INFO - No alerts generated!
2024-10-22 17:13:27 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:13:27 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:13:27 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:13:28 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:28 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:13:28 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:13:28 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:13:28 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:13:28 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:13:28 - INFO - No Alerts found!
2024-10-22 17:13:28 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:13:28 - INFO - No alerts generated!
2024-10-22 17:13:28 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:13:28 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:13:28 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:13:28 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:28 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:13:28 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:13:28 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:13:28 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:13:28 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:13:28 - INFO - No Alerts found!
2024-10-22 17:13:28 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:13:28 - INFO - No alerts generated!
2024-10-22 17:13:28 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:13:28 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:13:29 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:13:29 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:29 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:13:29 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:13:29 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:13:29 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:13:29 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:13:29 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:13:29 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:13:29 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:13:29 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:13:29 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:13:29 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:33 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:13:34 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:13:34 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:13:34 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:34 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:13:38 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:13:45 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:13:45 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:49 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:13:56 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:14:12 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:14:19 - ERROR - Database connection error: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'Unusual'. (102) (SQLExecDirectW)")
[SQL: 
                    INSERT INTO TS_ALERT_NARR (ALERT_INVSTN_ID, NARRATIVE, UPLOADED_BY, UPLOADED_DATE)
                    VALUES (3376, 'The alert with ID 1000001 was generated under the scenario named 'Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold).' This alert pertains to an individual customer, Olivia Mullen, whose account has an impressive age of 53 years and 8 months. The alert was triggered due to a total transaction amount of $262,644.15 observed during the lookback period from September 1, 2024, to September 30, 2024. This amount significantly exceeds the previous average transaction amount of $71,401.01, resulting in a risk percentage of 267.84, which categorizes the customer at a 'HIGH' risk level.

Despite the high transaction amount and risk percentage, the decision to autoclose this alert is supported by the fact that prior alerts for this customer have been reviewed and subsequently closed after investigation, being deemed as false positives. This historical context indicates that similar transaction patterns have not led to any findings of fraudulent behavior in the past. 

Furthermore, the substantial account age suggests a long-standing relationship with the financial institution, which typically correlates with established transaction patterns and customer behavior. The minimal nature of the activity, when viewed in the context of the customer's overall transaction history, reinforces the conclusion that this alert does not indicate any new or concerning activity. Therefore, it is recommended that this alert be autoclosed, as it aligns with the established criteria for false positives based on previous investigations.', 'system', '2024-10-22 17:14:18')
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2024-10-22 17:14:19 - ERROR - SQLAlchemy Error executing SQL query - 
                    INSERT INTO TS_ALERT_NARR (ALERT_INVSTN_ID, NARRATIVE, UPLOADED_BY, UPLOADED_DATE)
                    VALUES (3376, 'The alert with ID 1000001 was generated under the scenario named 'Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold).' This alert pertains to an individual customer, Olivia Mullen, whose account has an impressive age of 53 years and 8 months. The alert was triggered due to a total transaction amount of $262,644.15 observed during the lookback period from September 1, 2024, to September 30, 2024. This amount significantly exceeds the previous average transaction amount of $71,401.01, resulting in a risk percentage of 267.84, which categorizes the customer at a 'HIGH' risk level.

Despite the high transaction amount and risk percentage, the decision to autoclose this alert is supported by the fact that prior alerts for this customer have been reviewed and subsequently closed after investigation, being deemed as false positives. This historical context indicates that similar transaction patterns have not led to any findings of fraudulent behavior in the past. 

Furthermore, the substantial account age suggests a long-standing relationship with the financial institution, which typically correlates with established transaction patterns and customer behavior. The minimal nature of the activity, when viewed in the context of the customer's overall transaction history, reinforces the conclusion that this alert does not indicate any new or concerning activity. Therefore, it is recommended that this alert be autoclosed, as it aligns with the established criteria for false positives based on previous investigations.', 'system', '2024-10-22 17:14:18')
                     | (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near 'Unusual'. (102) (SQLExecDirectW)")
[SQL: 
                    INSERT INTO TS_ALERT_NARR (ALERT_INVSTN_ID, NARRATIVE, UPLOADED_BY, UPLOADED_DATE)
                    VALUES (3376, 'The alert with ID 1000001 was generated under the scenario named 'Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold).' This alert pertains to an individual customer, Olivia Mullen, whose account has an impressive age of 53 years and 8 months. The alert was triggered due to a total transaction amount of $262,644.15 observed during the lookback period from September 1, 2024, to September 30, 2024. This amount significantly exceeds the previous average transaction amount of $71,401.01, resulting in a risk percentage of 267.84, which categorizes the customer at a 'HIGH' risk level.

Despite the high transaction amount and risk percentage, the decision to autoclose this alert is supported by the fact that prior alerts for this customer have been reviewed and subsequently closed after investigation, being deemed as false positives. This historical context indicates that similar transaction patterns have not led to any findings of fraudulent behavior in the past. 

Furthermore, the substantial account age suggests a long-standing relationship with the financial institution, which typically correlates with established transaction patterns and customer behavior. The minimal nature of the activity, when viewed in the context of the customer's overall transaction history, reinforces the conclusion that this alert does not indicate any new or concerning activity. Therefore, it is recommended that this alert be autoclosed, as it aligns with the established criteria for false positives based on previous investigations.', 'system', '2024-10-22 17:14:18')
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2024-10-22 17:14:19 - INFO - Narrative data successfully pushed to TS_ALERT_NARR.
2024-10-22 17:14:19 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:14:27 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:14:33 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:14:38 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:14:38 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-10-22 17:14:38 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-10-22 17:14:38 - ERROR - No data found for scenario ID TS_SCN_29 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-10-22 17:14:38 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-10-22 17:14:38 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:14:38 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:14:46 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:14:46 - INFO - Pipeline execution completed successfully.
2024-10-22 17:20:52 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:20:52 - INFO - Starting scenario data retrieval.
2024-10-22 17:20:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:20:52 - INFO - Fetching scenario configuration data
2024-10-22 17:20:58 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:21:00 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:21:00 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:00 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:10 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:21:10 - INFO - Starting customer ID retrieval.
2024-10-22 17:21:10 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:20 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:21:20 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:21:20 - INFO - Starting threshold data retrieval.
2024-10-22 17:21:20 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:20 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:21:20 - INFO - Fetching threshold configuration data.
2024-10-22 17:21:20 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:21:20 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:21:24 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:21:24 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:21:24 - INFO - Starting customer ID processing.
2024-10-22 17:21:24 - INFO - Starting Parquet files processing.
2024-10-22 17:21:24 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:21:24 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:21:24 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:21:24 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:24 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:21:24 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:21:24 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:21:24 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:21:24 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:21:25 - INFO - No Alerts found!
2024-10-22 17:21:25 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:21:25 - INFO - No alerts generated!
2024-10-22 17:21:25 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:21:25 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:21:25 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:21:25 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:25 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:21:25 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:21:25 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:21:25 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:21:25 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:21:25 - INFO - No Alerts found!
2024-10-22 17:21:25 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:21:25 - INFO - No alerts generated!
2024-10-22 17:21:25 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:21:25 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:21:25 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:21:25 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:25 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:21:25 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:21:25 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:21:25 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:21:25 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:21:26 - INFO - No Alerts found!
2024-10-22 17:21:26 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:21:26 - INFO - No alerts generated!
2024-10-22 17:21:26 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:21:26 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:21:26 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:21:26 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:26 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:21:26 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:21:26 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:21:26 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:21:26 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:21:26 - INFO - No Alerts found!
2024-10-22 17:21:26 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:21:26 - INFO - No alerts generated!
2024-10-22 17:21:26 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:21:26 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:21:27 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:21:27 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:27 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:21:27 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:21:27 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:21:27 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:21:27 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:21:27 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:21:27 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:21:27 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:21:27 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:21:27 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:21:27 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:32 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:21:32 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:21:32 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:21:32 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:32 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:21:36 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:21:42 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:21:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:47 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:21:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:22:03 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:22:11 - INFO - Narrative data successfully pushed to TS_ALERT_NARR.
2024-10-22 17:22:11 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:22:19 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:22:25 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:22:31 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:22:31 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-10-22 17:22:31 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-10-22 17:22:31 - ERROR - No data found for scenario ID TS_SCN_29 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-10-22 17:22:31 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-10-22 17:22:32 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:22:32 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:22:38 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:22:38 - INFO - Pipeline execution completed successfully.
2024-10-22 17:25:15 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:25:15 - INFO - Starting scenario data retrieval.
2024-10-22 17:25:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:15 - INFO - Fetching scenario configuration data
2024-10-22 17:25:21 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:25:22 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:25:22 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:22 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:33 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:25:33 - INFO - Starting customer ID retrieval.
2024-10-22 17:25:33 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:44 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:25:44 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:25:44 - INFO - Starting threshold data retrieval.
2024-10-22 17:25:44 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:44 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:25:44 - INFO - Fetching threshold configuration data.
2024-10-22 17:25:44 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:25:44 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:25:48 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:25:48 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:25:48 - INFO - Starting customer ID processing.
2024-10-22 17:25:48 - INFO - Starting Parquet files processing.
2024-10-22 17:25:48 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:25:48 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:25:49 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:25:49 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:49 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:25:49 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:25:49 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:25:49 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:25:49 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:25:49 - INFO - No Alerts found!
2024-10-22 17:25:49 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:25:49 - INFO - No alerts generated!
2024-10-22 17:25:49 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:25:49 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:25:49 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:25:49 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:49 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:25:49 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:25:49 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:25:49 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:25:49 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:25:50 - INFO - No Alerts found!
2024-10-22 17:25:50 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:25:50 - INFO - No alerts generated!
2024-10-22 17:25:50 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:25:50 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:25:50 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:25:50 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:50 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:25:50 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:25:50 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:25:50 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:25:50 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:25:50 - INFO - No Alerts found!
2024-10-22 17:25:50 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:25:50 - INFO - No alerts generated!
2024-10-22 17:25:50 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:25:50 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:25:50 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:25:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:51 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:25:51 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:25:51 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:25:51 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:25:51 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:25:51 - INFO - No Alerts found!
2024-10-22 17:25:51 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:25:51 - INFO - No alerts generated!
2024-10-22 17:25:51 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:25:51 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:25:51 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:25:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:51 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:25:51 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:25:51 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:25:51 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:25:51 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:25:51 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:25:51 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:25:51 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:25:51 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:25:51 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:25:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:56 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:25:56 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:25:56 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:25:56 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:25:56 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:26:01 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:26:06 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:26:07 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:26:10 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:26:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:26:27 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:26:33 - ERROR - ALERT_INVSTN_ID not found for ALERT_ID 11393, skipping...
2024-10-22 17:26:33 - INFO - Narrative data successfully pushed to TS_ALERT_NARR.
2024-10-22 17:26:33 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:26:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:26:48 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:26:54 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:26:54 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-10-22 17:26:54 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-10-22 17:26:54 - ERROR - No data found for scenario ID TS_SCN_29 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-10-22 17:26:54 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-10-22 17:26:55 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:26:55 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:27:01 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:27:01 - INFO - Pipeline execution completed successfully.
2024-10-22 17:29:56 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:29:56 - INFO - Starting scenario data retrieval.
2024-10-22 17:29:56 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:29:56 - INFO - Fetching scenario configuration data
2024-10-22 17:30:02 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:30:03 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:30:03 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:03 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:09 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:30:09 - INFO - Starting customer ID retrieval.
2024-10-22 17:30:09 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:15 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:30:15 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:30:15 - INFO - Starting threshold data retrieval.
2024-10-22 17:30:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:15 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:30:15 - INFO - Fetching threshold configuration data.
2024-10-22 17:30:15 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:30:15 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:30:19 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:30:19 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:30:19 - INFO - Starting customer ID processing.
2024-10-22 17:30:19 - INFO - Starting Parquet files processing.
2024-10-22 17:30:19 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:30:19 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:30:20 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:30:20 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:20 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:30:20 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:30:20 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:30:20 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:30:20 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:30:20 - INFO - No Alerts found!
2024-10-22 17:30:20 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:30:20 - INFO - No alerts generated!
2024-10-22 17:30:20 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:30:20 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:30:21 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:30:21 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:21 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:30:21 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:30:21 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:30:21 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:30:21 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:30:21 - INFO - No Alerts found!
2024-10-22 17:30:21 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:30:21 - INFO - No alerts generated!
2024-10-22 17:30:21 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:30:21 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:30:21 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:30:21 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:21 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:30:21 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:30:21 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:30:21 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:30:21 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:30:21 - INFO - No Alerts found!
2024-10-22 17:30:21 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:30:21 - INFO - No alerts generated!
2024-10-22 17:30:21 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:30:21 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:30:22 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:30:22 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:22 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:30:22 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:30:22 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:30:22 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:30:22 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:30:22 - INFO - No Alerts found!
2024-10-22 17:30:22 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:30:22 - INFO - No alerts generated!
2024-10-22 17:30:22 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:30:22 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:30:22 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:30:22 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:22 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:30:22 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:30:22 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:30:22 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:30:22 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:30:22 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:30:22 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:30:22 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:30:22 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:30:22 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:30:22 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:27 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:30:27 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:30:27 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:30:27 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:27 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:30:31 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:30:36 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:30:37 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:40 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:45 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:30:54 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:31:00 - ERROR - ALERT_INVSTN_ID not found for ALERT_ID 11393, skipping...
2024-10-22 17:31:00 - INFO - Narrative data successfully pushed to TS_ALERT_NARR.
2024-10-22 17:31:00 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:31:08 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:31:13 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:31:19 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:31:19 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-10-22 17:31:19 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-10-22 17:31:19 - ERROR - No data found for scenario ID TS_SCN_29 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-10-22 17:31:19 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-10-22 17:31:19 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:31:19 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:31:24 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:31:24 - INFO - Pipeline execution completed successfully.
2024-10-22 17:32:52 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:32:52 - INFO - Starting scenario data retrieval.
2024-10-22 17:32:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:32:52 - INFO - Fetching scenario configuration data
2024-10-22 17:32:58 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:32:59 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:32:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:32:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:09 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:33:09 - INFO - Starting customer ID retrieval.
2024-10-22 17:33:09 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:26 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:33:26 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:33:26 - INFO - Starting threshold data retrieval.
2024-10-22 17:33:26 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:26 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:33:26 - INFO - Fetching threshold configuration data.
2024-10-22 17:33:26 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:33:26 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:33:30 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:33:30 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:33:30 - INFO - Starting customer ID processing.
2024-10-22 17:33:30 - INFO - Starting Parquet files processing.
2024-10-22 17:33:30 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:33:30 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:33:30 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:33:31 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:31 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:33:31 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:33:31 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:33:31 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:33:31 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:33:31 - INFO - No Alerts found!
2024-10-22 17:33:31 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:33:31 - INFO - No alerts generated!
2024-10-22 17:33:31 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:33:31 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:33:31 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:33:31 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:31 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:33:31 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:33:31 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:33:31 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:33:31 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:33:31 - INFO - No Alerts found!
2024-10-22 17:33:31 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:33:31 - INFO - No alerts generated!
2024-10-22 17:33:31 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:33:31 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:33:32 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:33:32 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:32 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:33:32 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:33:32 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:33:32 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:33:32 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:33:32 - INFO - No Alerts found!
2024-10-22 17:33:32 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:33:32 - INFO - No alerts generated!
2024-10-22 17:33:32 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:33:32 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:33:32 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:33:32 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:32 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:33:32 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:33:32 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:33:32 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:33:32 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:33:32 - INFO - No Alerts found!
2024-10-22 17:33:32 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:33:32 - INFO - No alerts generated!
2024-10-22 17:33:32 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:33:32 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:33:33 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:33:33 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:33 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:33:33 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:33:33 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:33:33 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:33:33 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:33:33 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:33:33 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:33:33 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:33:33 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:33:33 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:33:33 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:39 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:33:39 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:33:39 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:33:39 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:39 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:33:44 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:33:49 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:33:49 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:33:53 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:34:00 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:34:12 - ERROR - Error occurred while mapping generated ALERT_ID with alert risk scoring data: 'Alert_ID'
2024-10-22 17:34:12 - ERROR - Error while pushing alert data: 'Alert_ID'
2024-10-22 17:34:12 - ERROR - Error processing data with ALERTCHECKER: 'Alert_ID'
Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_scenarios/scenario_manager.py", line 115, in process_with_alert_checker
    alert_pusher.push_alerts(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 556, in push_alerts
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 546, in push_alerts
    self.push_alert_score_data(job_details, alert_id_mapping_dict, alert_table, ars_table)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 515, in push_alert_score_data
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 441, in push_alert_score_data
    narrative_data = pd.merge(narrative_data, ars_table, on='Alert_ID', how='left')
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 170, in merge
    op = _MergeOperation(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 794, in __init__
    ) = self._get_merge_keys()
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 1310, in _get_merge_keys
    left_keys.append(left._get_label_or_level_values(lk))
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'Alert_ID'
2024-10-22 17:34:12 - ERROR - Error processing Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:34:12 - INFO - All data fetched: 915730 transactions | Total unique customers: 124753
2024-10-22 17:34:13 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:34:13 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:34:19 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:34:19 - INFO - Pipeline execution completed successfully.
2024-10-22 17:35:10 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:35:10 - INFO - Starting scenario data retrieval.
2024-10-22 17:35:10 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:10 - INFO - Fetching scenario configuration data
2024-10-22 17:35:17 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:35:17 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:35:18 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:18 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:25 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:35:25 - INFO - Starting customer ID retrieval.
2024-10-22 17:35:25 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:35 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:35:36 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:35:36 - INFO - Starting threshold data retrieval.
2024-10-22 17:35:36 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:36 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:35:36 - INFO - Fetching threshold configuration data.
2024-10-22 17:35:36 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:35:36 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:35:40 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:35:40 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:35:40 - INFO - Starting customer ID processing.
2024-10-22 17:35:40 - INFO - Starting Parquet files processing.
2024-10-22 17:35:40 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:35:40 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:35:40 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:35:41 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:41 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:35:41 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:35:41 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:35:41 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:35:41 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:35:41 - INFO - No Alerts found!
2024-10-22 17:35:41 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:35:41 - INFO - No alerts generated!
2024-10-22 17:35:41 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:35:41 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:35:41 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:35:41 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:41 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:35:41 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:35:41 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:35:41 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:35:41 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:35:41 - INFO - No Alerts found!
2024-10-22 17:35:41 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:35:41 - INFO - No alerts generated!
2024-10-22 17:35:41 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:35:41 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:35:41 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:35:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:42 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:35:42 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:35:42 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:35:42 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:35:42 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:35:42 - INFO - No Alerts found!
2024-10-22 17:35:42 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:35:42 - INFO - No alerts generated!
2024-10-22 17:35:42 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:35:42 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:35:42 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:35:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:42 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:35:42 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:35:42 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:35:42 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:35:42 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:35:42 - INFO - No Alerts found!
2024-10-22 17:35:42 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:35:42 - INFO - No alerts generated!
2024-10-22 17:35:42 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:35:42 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:35:43 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:35:43 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:43 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:35:43 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:35:43 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:35:43 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:35:43 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:35:43 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:35:43 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:35:43 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:35:43 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:35:43 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:35:43 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:48 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:35:48 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:35:48 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:35:48 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:35:48 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:35:52 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:35:58 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:35:58 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:36:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:36:07 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:36:24 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:36:30 - ERROR - ALERT_INVSTN_ID not found for ALERT_ID 11393, skipping...
2024-10-22 17:36:30 - INFO - Narrative data successfully pushed to TS_ALERT_NARR.
2024-10-22 17:36:30 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:36:37 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:36:43 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:36:49 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:36:49 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-10-22 17:36:49 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-10-22 17:36:49 - ERROR - No data found for scenario ID TS_SCN_29 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-10-22 17:36:49 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-10-22 17:36:49 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:36:49 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:36:55 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:36:55 - INFO - Pipeline execution completed successfully.
2024-10-22 17:38:47 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:38:47 - INFO - Starting scenario data retrieval.
2024-10-22 17:38:47 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:38:47 - INFO - Fetching scenario configuration data
2024-10-22 17:38:53 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:38:54 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:38:54 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:38:54 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:03 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:39:03 - INFO - Starting customer ID retrieval.
2024-10-22 17:39:03 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:09 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:39:09 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:39:09 - INFO - Starting threshold data retrieval.
2024-10-22 17:39:09 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:09 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:39:09 - INFO - Fetching threshold configuration data.
2024-10-22 17:39:09 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:39:09 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:39:13 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:39:14 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:39:14 - INFO - Starting customer ID processing.
2024-10-22 17:39:14 - INFO - Starting Parquet files processing.
2024-10-22 17:39:14 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:39:14 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:39:14 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:39:14 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:14 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:39:14 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:39:14 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:39:14 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:39:14 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:39:15 - INFO - No Alerts found!
2024-10-22 17:39:15 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:39:15 - INFO - No alerts generated!
2024-10-22 17:39:15 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:39:15 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:39:15 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:39:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:15 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:39:15 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:39:15 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:39:15 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:39:15 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:39:15 - INFO - No Alerts found!
2024-10-22 17:39:15 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:39:15 - INFO - No alerts generated!
2024-10-22 17:39:15 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:39:15 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:39:15 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:39:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:15 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:39:15 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:39:15 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:39:15 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:39:15 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:39:16 - INFO - No Alerts found!
2024-10-22 17:39:16 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:39:16 - INFO - No alerts generated!
2024-10-22 17:39:16 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:39:16 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:39:16 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:39:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:16 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:39:16 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:39:16 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:39:16 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:39:16 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:39:16 - INFO - No Alerts found!
2024-10-22 17:39:16 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:39:16 - INFO - No alerts generated!
2024-10-22 17:39:16 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:39:16 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:39:16 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:39:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:16 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:39:16 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:39:16 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:39:16 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:39:16 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:39:17 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:39:17 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:39:17 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:39:17 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:39:17 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:39:17 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:20 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:39:20 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:39:20 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:39:20 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:20 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:39:24 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:39:29 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:39:29 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:33 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:38 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:49 - ERROR - Error occurred while mapping generated ALERT_ID with alert risk scoring data: 'Alert_ID'
2024-10-22 17:39:49 - ERROR - Error while pushing alert data: 'Alert_ID'
2024-10-22 17:39:49 - ERROR - Error processing data with ALERTCHECKER: 'Alert_ID'
Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_scenarios/scenario_manager.py", line 115, in process_with_alert_checker
    alert_pusher.push_alerts(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 553, in push_alerts
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 543, in push_alerts
    self.push_alert_score_data(job_details, alert_id_mapping_dict, alert_table, ars_table)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 512, in push_alert_score_data
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 444, in push_alert_score_data
    self.push_investigation_details(job_details, alert_table, narrative_data)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 309, in push_investigation_details
    ars_table = pd.merge(ars_table, alert_table, on='Alert_ID', how='left')
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 170, in merge
    op = _MergeOperation(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 794, in __init__
    ) = self._get_merge_keys()
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/reshape/merge.py", line 1310, in _get_merge_keys
    left_keys.append(left._get_label_or_level_values(lk))
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'Alert_ID'
2024-10-22 17:39:49 - ERROR - Error processing Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:39:49 - INFO - All data fetched: 915730 transactions | Total unique customers: 124753
2024-10-22 17:39:49 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:39:49 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:39:55 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:39:55 - INFO - Pipeline execution completed successfully.
2024-10-22 17:43:10 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:43:10 - INFO - Starting scenario data retrieval.
2024-10-22 17:43:10 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:10 - INFO - Fetching scenario configuration data
2024-10-22 17:43:15 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:43:16 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:43:17 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:17 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:25 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:43:25 - INFO - Starting customer ID retrieval.
2024-10-22 17:43:25 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:36 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:43:36 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:43:36 - INFO - Starting threshold data retrieval.
2024-10-22 17:43:36 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:36 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:43:36 - INFO - Fetching threshold configuration data.
2024-10-22 17:43:36 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:43:36 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:43:40 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:43:40 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:43:40 - INFO - Starting customer ID processing.
2024-10-22 17:43:40 - INFO - Starting Parquet files processing.
2024-10-22 17:43:40 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:43:40 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:43:41 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:43:41 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:41 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:43:41 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:43:41 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:43:41 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:43:41 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:43:41 - INFO - No Alerts found!
2024-10-22 17:43:41 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:43:41 - INFO - No alerts generated!
2024-10-22 17:43:41 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:43:41 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:43:41 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:43:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:42 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:43:42 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:43:42 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:43:42 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:43:42 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:43:42 - INFO - No Alerts found!
2024-10-22 17:43:42 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:43:42 - INFO - No alerts generated!
2024-10-22 17:43:42 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:43:42 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:43:42 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:43:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:42 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:43:42 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:43:42 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:43:42 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:43:42 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:43:42 - INFO - No Alerts found!
2024-10-22 17:43:42 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:43:42 - INFO - No alerts generated!
2024-10-22 17:43:42 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:43:42 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:43:43 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:43:43 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:43 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:43:43 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:43:43 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:43:43 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:43:43 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:43:43 - INFO - No Alerts found!
2024-10-22 17:43:43 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:43:43 - INFO - No alerts generated!
2024-10-22 17:43:43 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:43:43 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:43:43 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:43:43 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:43 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:43:43 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:43:43 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:43:43 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:43:43 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:43:43 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:43:43 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:43:43 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:43:44 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:43:44 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:43:44 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:48 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:43:48 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:43:48 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:43:48 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:43:48 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:43:52 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:43:59 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:44:00 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:44:03 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:44:09 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:44:14 - ERROR - Error occurred while mapping generated ALERT_ID with alert risk scoring data: generate_narratives_for_autoclosure() missing 1 required positional argument: 'alert_id_mapping_dict'
2024-10-22 17:44:14 - ERROR - Error while pushing alert data: generate_narratives_for_autoclosure() missing 1 required positional argument: 'alert_id_mapping_dict'
2024-10-22 17:44:14 - ERROR - Error processing data with ALERTCHECKER: generate_narratives_for_autoclosure() missing 1 required positional argument: 'alert_id_mapping_dict'
Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_scenarios/scenario_manager.py", line 115, in process_with_alert_checker
    alert_pusher.push_alerts(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 551, in push_alerts
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 541, in push_alerts
    self.push_alert_score_data(job_details, alert_id_mapping_dict, alert_table, ars_table)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 510, in push_alert_score_data
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 434, in push_alert_score_data
    narrative_data = generate_narratives_for_autoclosure(ars_table)
TypeError: generate_narratives_for_autoclosure() missing 1 required positional argument: 'alert_id_mapping_dict'
2024-10-22 17:44:14 - ERROR - Error processing Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:44:14 - INFO - All data fetched: 915730 transactions | Total unique customers: 124753
2024-10-22 17:44:15 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:44:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:44:20 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:44:20 - INFO - Pipeline execution completed successfully.
2024-10-22 17:44:51 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:44:51 - INFO - Starting scenario data retrieval.
2024-10-22 17:44:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:44:51 - INFO - Fetching scenario configuration data
2024-10-22 17:44:57 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:44:58 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:44:58 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:44:58 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:07 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:45:07 - INFO - Starting customer ID retrieval.
2024-10-22 17:45:07 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:13 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:45:14 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:45:14 - INFO - Starting threshold data retrieval.
2024-10-22 17:45:14 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:14 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:45:14 - INFO - Fetching threshold configuration data.
2024-10-22 17:45:14 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:45:14 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:45:17 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:45:18 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:45:18 - INFO - Starting customer ID processing.
2024-10-22 17:45:18 - INFO - Starting Parquet files processing.
2024-10-22 17:45:18 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:45:18 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:45:18 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:45:18 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:18 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:45:18 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:45:18 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:45:18 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:45:18 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:45:19 - INFO - No Alerts found!
2024-10-22 17:45:19 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:45:19 - INFO - No alerts generated!
2024-10-22 17:45:19 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:45:19 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:45:19 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:45:19 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:19 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:45:19 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:45:19 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:45:19 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:45:19 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:45:19 - INFO - No Alerts found!
2024-10-22 17:45:19 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:45:19 - INFO - No alerts generated!
2024-10-22 17:45:19 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:45:19 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:45:19 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:45:20 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:20 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:45:20 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:45:20 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:45:20 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:45:20 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:45:20 - INFO - No Alerts found!
2024-10-22 17:45:20 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:45:20 - INFO - No alerts generated!
2024-10-22 17:45:20 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:45:20 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:45:20 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:45:20 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:20 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:45:20 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:45:20 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:45:20 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:45:20 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:45:20 - INFO - No Alerts found!
2024-10-22 17:45:20 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:45:20 - INFO - No alerts generated!
2024-10-22 17:45:20 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:45:20 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:45:21 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:45:21 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:21 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:45:21 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:45:21 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:45:21 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:45:21 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:45:21 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:45:21 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:45:21 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:45:21 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:45:21 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:45:21 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:26 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:45:26 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:45:26 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:45:26 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:26 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:45:30 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:45:36 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:45:36 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:39 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:46 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:45:57 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:46:04 - ERROR - Error occurred while mapping generated ALERT_ID with alert risk scoring data: 'Alert_ID'
2024-10-22 17:46:04 - ERROR - Error while pushing alert data: 'Alert_ID'
2024-10-22 17:46:04 - ERROR - Error processing data with ALERTCHECKER: 'Alert_ID'
Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Alert_ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_scenarios/scenario_manager.py", line 115, in process_with_alert_checker
    alert_pusher.push_alerts(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 551, in push_alerts
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 541, in push_alerts
    self.push_alert_score_data(job_details, alert_id_mapping_dict, alert_table, ars_table)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 510, in push_alert_score_data
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 444, in push_alert_score_data
    self.push_auto_closure_narrative(narrative_data, alert_id_mapping_dict)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 259, in push_auto_closure_narrative
    narrative_data["Alert_ID"].astype(int).map(alert_id_mapping_dict)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Alert_ID'
2024-10-22 17:46:04 - ERROR - Error processing Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:46:04 - INFO - All data fetched: 915730 transactions | Total unique customers: 124753
2024-10-22 17:46:04 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:46:04 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:46:09 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:46:09 - INFO - Pipeline execution completed successfully.
2024-10-22 17:47:10 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:47:10 - INFO - Starting scenario data retrieval.
2024-10-22 17:47:10 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:10 - INFO - Fetching scenario configuration data
2024-10-22 17:47:15 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:47:16 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:47:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:25 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:47:25 - INFO - Starting customer ID retrieval.
2024-10-22 17:47:25 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:41 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:47:42 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:47:42 - INFO - Starting threshold data retrieval.
2024-10-22 17:47:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:42 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:47:42 - INFO - Fetching threshold configuration data.
2024-10-22 17:47:42 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:47:42 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:47:45 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:47:45 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:47:45 - INFO - Starting customer ID processing.
2024-10-22 17:47:45 - INFO - Starting Parquet files processing.
2024-10-22 17:47:45 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:47:45 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:47:46 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:47:46 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:46 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:47:46 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:47:46 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:47:46 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:47:46 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:47:46 - INFO - No Alerts found!
2024-10-22 17:47:46 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:47:46 - INFO - No alerts generated!
2024-10-22 17:47:46 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:47:46 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:47:46 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:47:46 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:46 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:47:46 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:47:46 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:47:46 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:47:46 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:47:47 - INFO - No Alerts found!
2024-10-22 17:47:47 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:47:47 - INFO - No alerts generated!
2024-10-22 17:47:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:47:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:47:47 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:47:47 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:47:47 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:47:47 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:47:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:47:47 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:47:47 - INFO - No Alerts found!
2024-10-22 17:47:47 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:47:47 - INFO - No alerts generated!
2024-10-22 17:47:47 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:47:47 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:47:47 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:47:47 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:47 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:47:47 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:47:47 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:47:47 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:47:47 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:47:48 - INFO - No Alerts found!
2024-10-22 17:47:48 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:47:48 - INFO - No alerts generated!
2024-10-22 17:47:48 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:47:48 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:47:48 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:47:48 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:48 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:47:48 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:47:48 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:47:48 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:47:48 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:47:48 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:47:48 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:47:48 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:47:48 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:47:48 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:47:48 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:52 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:47:52 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:47:52 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:47:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:47:52 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:47:56 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:48:01 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:48:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:48:05 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:48:11 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:48:22 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:48:29 - ERROR - Error occurred while mapping generated ALERT_ID with alert risk scoring data: 'Alert_ID'
2024-10-22 17:48:29 - ERROR - Error while pushing alert data: 'Alert_ID'
2024-10-22 17:48:29 - ERROR - Error processing data with ALERTCHECKER: 'Alert_ID'
Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Alert_ID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_scenarios/scenario_manager.py", line 115, in process_with_alert_checker
    alert_pusher.push_alerts(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 551, in push_alerts
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 541, in push_alerts
    self.push_alert_score_data(job_details, alert_id_mapping_dict, alert_table, ars_table)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 510, in push_alert_score_data
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 444, in push_alert_score_data
    self.push_auto_closure_narrative(narrative_data, alert_id_mapping_dict)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/data_pusher.py", line 259, in push_auto_closure_narrative
    narrative_data["Alert_ID"].astype(int).map(alert_id_mapping_dict)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Alert_ID'
2024-10-22 17:48:29 - ERROR - Error processing Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:48:29 - INFO - All data fetched: 915730 transactions | Total unique customers: 124753
2024-10-22 17:48:29 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:48:29 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:48:35 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:48:35 - INFO - Pipeline execution completed successfully.
2024-10-22 17:50:26 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_29'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-10-22 17:50:26 - INFO - Starting scenario data retrieval.
2024-10-22 17:50:26 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:26 - INFO - Fetching scenario configuration data
2024-10-22 17:50:32 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_29')
        
2024-10-22 17:50:33 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-10-22 17:50:34 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:34 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:42 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-10-22 17:50:42 - INFO - Starting customer ID retrieval.
2024-10-22 17:50:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:52 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-10-22 17:50:52 - INFO - Successfully fetched 125001 customer IDs.
2024-10-22 17:50:52 - INFO - Starting threshold data retrieval.
2024-10-22 17:50:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:52 - INFO - SQLQueryExecutor initialized successfully.
2024-10-22 17:50:52 - INFO - Fetching threshold configuration data.
2024-10-22 17:50:52 - DEBUG - Processing scenario ID: TS_SCN_29
2024-10-22 17:50:52 - DEBUG - Executing SQL query for scenario ID TS_SCN_29: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:50:56 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_29'
     AND TS_THRESHOLD_SET.IS_ACTIVE = 1
2024-10-22 17:50:56 - INFO - Threshold data fetching completed successfully.
2024-10-22 17:50:56 - INFO - Starting customer ID processing.
2024-10-22 17:50:56 - INFO - Starting Parquet files processing.
2024-10-22 17:50:56 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-10-22 17:50:56 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-10-22 17:50:57 - INFO - Fetched 303275 transactions | Total unique customers: 24995
2024-10-22 17:50:57 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:57 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:50:57 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:50:57 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:50:57 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:50:57 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:50:57 - INFO - No Alerts found!
2024-10-22 17:50:57 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:50:57 - INFO - No alerts generated!
2024-10-22 17:50:57 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_29
2024-10-22 17:50:57 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-10-22 17:50:57 - INFO - Fetched 150729 transactions | Total unique customers: 49966
2024-10-22 17:50:57 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:57 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:50:57 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:50:57 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:50:57 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:50:57 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:50:57 - INFO - No Alerts found!
2024-10-22 17:50:57 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:50:57 - INFO - No alerts generated!
2024-10-22 17:50:57 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_29
2024-10-22 17:50:57 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-10-22 17:50:58 - INFO - Fetched 149887 transactions | Total unique customers: 74931
2024-10-22 17:50:58 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:58 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:50:58 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:50:58 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:50:58 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:50:58 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:50:58 - INFO - No Alerts found!
2024-10-22 17:50:58 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:50:58 - INFO - No alerts generated!
2024-10-22 17:50:58 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_29
2024-10-22 17:50:58 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-10-22 17:50:58 - INFO - Fetched 155762 transactions | Total unique customers: 99859
2024-10-22 17:50:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:59 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:50:59 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:50:59 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:50:59 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:50:59 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:50:59 - INFO - No Alerts found!
2024-10-22 17:50:59 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-10-22 17:50:59 - INFO - No alerts generated!
2024-10-22 17:50:59 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_29
2024-10-22 17:50:59 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-10-22 17:50:59 - INFO - Fetched 156077 transactions | Total unique customers: 124753
2024-10-22 17:50:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:50:59 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_29
2024-10-22 17:50:59 - INFO - ALERTCHECKER initialized successfully.
2024-10-22 17:50:59 - INFO - Initializing AlertChecker for TS_SCN_29
2024-10-22 17:50:59 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_29
2024-10-22 17:50:59 - INFO - EvidenceReportGenerator initialized successfully.
2024-10-22 17:50:59 - INFO - Job ID - 157 | Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) | Total no. of alerts found - 1
2024-10-22 17:50:59 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-10-22 17:50:59 - INFO - Generated alert transaction table with 3 rows.
2024-10-22 17:50:59 - INFO - Generated evidence report with 1 rows.
2024-10-22 17:50:59 - INFO - Generated alert customer account mapping table with 1 rows.
2024-10-22 17:50:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:51:04 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_29'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-10-22 17:51:04 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-10-22 17:51:04 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) AlertRiskScoring has been initialized.
2024-10-22 17:51:04 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:51:04 - INFO - Unusual MI Transfer Activity Exceeding (Risk %) and ($ Threshold) : calculating Prior Alert Scores.
2024-10-22 17:51:08 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.ACCT_ID IN ('1131345579')
                    AND TS_ALERT.CREATED_DATE >= '2024-01-22'
                
2024-10-22 17:51:14 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-10-22 17:51:15 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:51:18 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:51:24 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:51:35 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:51:42 - INFO - Narrative data successfully pushed to TS_ALERT_NARR.
2024-10-22 17:51:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:51:49 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:51:55 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:52:00 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_29
2024-10-22 17:52:00 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-10-22 17:52:00 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-10-22 17:52:00 - ERROR - No data found for scenario ID TS_SCN_29 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-10-22 17:52:00 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-10-22 17:52:01 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-10-22 17:52:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-10-22 17:52:06 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-10-22 17:52:06 - INFO - Pipeline execution completed successfully.

2024-09-25 16:25:35 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_01'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-09-25 16:25:35 - INFO - Starting scenario data retrieval.
2024-09-25 16:25:35 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:25:35 - INFO - Fetching scenario configuration data
2024-09-25 16:25:41 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_01')
        
2024-09-25 16:25:42 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-09-25 16:25:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:25:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:25:51 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-09-25 16:25:51 - INFO - Starting customer ID retrieval.
2024-09-25 16:25:51 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:26:00 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-09-25 16:26:00 - INFO - Successfully fetched 125001 customer IDs.
2024-09-25 16:26:00 - INFO - Starting threshold data retrieval.
2024-09-25 16:26:00 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:26:00 - INFO - SQLQueryExecutor initialized successfully.
2024-09-25 16:26:00 - INFO - Fetching threshold configuration data.
2024-09-25 16:26:00 - DEBUG - Processing scenario ID: TS_SCN_01
2024-09-25 16:26:00 - DEBUG - Executing SQL query for scenario ID TS_SCN_01: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND IS_ACTIVE = 1
2024-09-25 16:26:04 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND IS_ACTIVE = 1
2024-09-25 16:26:04 - INFO - Threshold data fetching completed successfully.
2024-09-25 16:26:04 - INFO - Starting customer ID processing.
2024-09-25 16:26:04 - INFO - Starting Parquet files processing.
2024-09-25 16:26:04 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-09-25 16:26:04 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-09-25 16:26:05 - INFO - Fetched 303374 transactions | Total unique customers: 24995
2024-09-25 16:26:05 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:26:05 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 16:26:05 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 16:26:05 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 16:26:05 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 16:26:05 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 16:26:24 - INFO - Total alerts found - 2
2024-09-25 16:26:24 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 2
2024-09-25 16:26:24 - INFO - Generated alert transaction table with 6 rows.
2024-09-25 16:26:24 - INFO - Generated evidence report with 2 rows.
2024-09-25 16:26:24 - INFO - Generated alert customer account mapping table with 2 rows.
2024-09-25 16:26:24 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:26:29 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_01'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-09-25 16:26:29 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-09-25 16:26:29 - INFO - High Risk Geography (Customer) AlertRiskScoring has been initialized.
2024-09-25 16:26:29 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:26:29 - INFO - High Risk Geography (Customer) : calculating Prior Alert Scores.
2024-09-25 16:26:34 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.CUST_ID IN ('19Ae0bcab8DAa6A', '18c360a92A58E0f')
                    AND TS_ALERT.CREATED_DATE >= '2024-03-25'
                
2024-09-25 16:26:34 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:50:52 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_01'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-09-25 16:50:52 - INFO - Starting scenario data retrieval.
2024-09-25 16:50:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:50:52 - INFO - Fetching scenario configuration data
2024-09-25 16:50:57 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_01')
        
2024-09-25 16:50:58 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-09-25 16:50:58 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:50:58 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:51:08 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-09-25 16:51:08 - INFO - Starting customer ID retrieval.
2024-09-25 16:51:08 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:51:18 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-09-25 16:51:19 - INFO - Successfully fetched 125001 customer IDs.
2024-09-25 16:51:19 - INFO - Starting threshold data retrieval.
2024-09-25 16:51:19 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:51:19 - INFO - SQLQueryExecutor initialized successfully.
2024-09-25 16:51:19 - INFO - Fetching threshold configuration data.
2024-09-25 16:51:19 - DEBUG - Processing scenario ID: TS_SCN_01
2024-09-25 16:51:19 - DEBUG - Executing SQL query for scenario ID TS_SCN_01: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND IS_ACTIVE = 1
2024-09-25 16:51:22 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND IS_ACTIVE = 1
2024-09-25 16:51:22 - INFO - Threshold data fetching completed successfully.
2024-09-25 16:51:22 - INFO - Starting customer ID processing.
2024-09-25 16:51:22 - INFO - Starting Parquet files processing.
2024-09-25 16:51:22 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-09-25 16:51:22 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-09-25 16:51:23 - INFO - Fetched 303374 transactions | Total unique customers: 24995
2024-09-25 16:51:23 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:51:23 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 16:51:23 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 16:51:23 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 16:51:23 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 16:51:23 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 16:51:42 - INFO - Total alerts found - 2
2024-09-25 16:51:42 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 2
2024-09-25 16:51:42 - INFO - Generated alert transaction table with 6 rows.
2024-09-25 16:51:42 - INFO - Generated evidence report with 2 rows.
2024-09-25 16:51:42 - INFO - Generated alert customer account mapping table with 2 rows.
2024-09-25 16:51:42 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:51:47 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_01'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-09-25 16:51:47 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-09-25 16:51:47 - INFO - High Risk Geography (Customer) AlertRiskScoring has been initialized.
2024-09-25 16:51:47 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:51:47 - INFO - High Risk Geography (Customer) : calculating Prior Alert Scores.
2024-09-25 16:51:52 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.CUST_ID IN ('19Ae0bcab8DAa6A', '18c360a92A58E0f')
                    AND TS_ALERT.CREATED_DATE >= '2024-03-25'
                
2024-09-25 16:51:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:51:57 - INFO - Successfully executed query: SELECT * FROM TS_COUNTRY
2024-09-25 16:51:57 - INFO - Scenario - High Risk Geography (Customer) | Country risk flags fetched successfully.
2024-09-25 16:51:57 - INFO - Scenario - High Risk Geography (Customer) | Country risk score calculated successfully.
2024-09-25 16:52:01 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-09-25 16:52:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:52:01 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_01
2024-09-25 16:52:01 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-09-25 16:52:01 - INFO - Fetched 150691 transactions | Total unique customers: 49966
2024-09-25 16:52:01 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:52:01 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 16:52:01 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 16:52:01 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 16:52:01 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 16:52:01 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 16:52:18 - INFO - No Alerts found!
2024-09-25 16:52:18 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 16:52:18 - INFO - No alerts generated!
2024-09-25 16:52:18 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_01
2024-09-25 16:52:18 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-09-25 16:52:19 - INFO - Fetched 149892 transactions | Total unique customers: 74931
2024-09-25 16:52:19 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:52:19 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 16:52:19 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 16:52:19 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 16:52:19 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 16:52:19 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 16:52:38 - INFO - Total alerts found - 1
2024-09-25 16:52:38 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-09-25 16:52:38 - INFO - Generated alert transaction table with 3 rows.
2024-09-25 16:52:38 - INFO - Generated evidence report with 1 rows.
2024-09-25 16:52:38 - INFO - Generated alert customer account mapping table with 1 rows.
2024-09-25 16:52:38 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:52:43 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_01'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-09-25 16:52:44 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-09-25 16:52:44 - INFO - High Risk Geography (Customer) AlertRiskScoring has been initialized.
2024-09-25 16:52:44 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:52:44 - INFO - High Risk Geography (Customer) : calculating Prior Alert Scores.
2024-09-25 16:52:48 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.CUST_ID IN ('B5AEa3DCBC5f0E1')
                    AND TS_ALERT.CREATED_DATE >= '2024-03-25'
                
2024-09-25 16:52:48 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:52:53 - INFO - Successfully executed query: SELECT * FROM TS_COUNTRY
2024-09-25 16:52:53 - INFO - Scenario - High Risk Geography (Customer) | Country risk flags fetched successfully.
2024-09-25 16:52:53 - INFO - Scenario - High Risk Geography (Customer) | Country risk score calculated successfully.
2024-09-25 16:52:59 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-09-25 16:52:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:52:59 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_01
2024-09-25 16:52:59 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-09-25 16:52:59 - INFO - Fetched 155768 transactions | Total unique customers: 99859
2024-09-25 16:52:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:52:59 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 16:52:59 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 16:52:59 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 16:52:59 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 16:52:59 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 16:53:17 - INFO - No Alerts found!
2024-09-25 16:53:17 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 16:53:17 - INFO - No alerts generated!
2024-09-25 16:53:17 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_01
2024-09-25 16:53:17 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-09-25 16:53:17 - INFO - Fetched 156005 transactions | Total unique customers: 124753
2024-09-25 16:53:17 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:53:17 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 16:53:17 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 16:53:17 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 16:53:17 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 16:53:17 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 16:53:36 - INFO - No Alerts found!
2024-09-25 16:53:36 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 16:53:36 - INFO - No alerts generated!
2024-09-25 16:53:36 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_01
2024-09-25 16:53:36 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-09-25 16:53:36 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-09-25 16:53:36 - ERROR - No data found for scenario ID TS_SCN_01 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-09-25 16:53:36 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-09-25 16:53:37 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-09-25 16:53:37 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 16:53:42 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-09-25 16:53:42 - INFO - Pipeline execution completed successfully.
2024-09-25 17:05:12 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_01'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-09-25 17:05:12 - INFO - Starting scenario data retrieval.
2024-09-25 17:05:12 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:05:12 - INFO - Fetching scenario configuration data
2024-09-25 17:05:16 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_01')
        
2024-09-25 17:05:17 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-09-25 17:05:17 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:05:17 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:05:26 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-09-25 17:05:26 - INFO - Starting customer ID retrieval.
2024-09-25 17:05:26 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:05:35 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-09-25 17:05:35 - INFO - Successfully fetched 125001 customer IDs.
2024-09-25 17:05:35 - INFO - Starting threshold data retrieval.
2024-09-25 17:05:35 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:05:35 - INFO - SQLQueryExecutor initialized successfully.
2024-09-25 17:05:35 - INFO - Fetching threshold configuration data.
2024-09-25 17:05:35 - DEBUG - Processing scenario ID: TS_SCN_01
2024-09-25 17:05:35 - DEBUG - Executing SQL query for scenario ID TS_SCN_01: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND IS_ACTIVE = 1
2024-09-25 17:05:38 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND IS_ACTIVE = 1
2024-09-25 17:05:39 - INFO - Threshold data fetching completed successfully.
2024-09-25 17:05:39 - INFO - Starting customer ID processing.
2024-09-25 17:05:39 - INFO - Starting Parquet files processing.
2024-09-25 17:05:39 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-09-25 17:05:39 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-09-25 17:05:39 - INFO - Fetched 303374 transactions | Total unique customers: 24995
2024-09-25 17:05:39 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:05:39 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 17:05:39 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 17:05:39 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 17:05:39 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 17:05:39 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 17:05:58 - INFO - Total alerts found - 2
2024-09-25 17:05:58 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 2
2024-09-25 17:05:58 - INFO - Generated alert transaction table with 6 rows.
2024-09-25 17:05:58 - INFO - Generated evidence report with 2 rows.
2024-09-25 17:05:58 - INFO - Generated alert customer account mapping table with 2 rows.
2024-09-25 17:05:58 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:06:03 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_01'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-09-25 17:06:03 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-09-25 17:06:03 - INFO - High Risk Geography (Customer) AlertRiskScoring has been initialized.
2024-09-25 17:06:03 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:06:03 - INFO - High Risk Geography (Customer) : calculating Prior Alert Scores.
2024-09-25 17:06:08 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.CUST_ID IN ('19Ae0bcab8DAa6A', '18c360a92A58E0f')
                    AND TS_ALERT.CREATED_DATE >= '2024-03-25'
                
2024-09-25 17:06:08 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:06:13 - INFO - Successfully executed query: SELECT * FROM TS_COUNTRY
2024-09-25 17:06:13 - INFO - Scenario - High Risk Geography (Customer) | Country risk flags fetched successfully.
2024-09-25 17:06:13 - INFO - Scenario - High Risk Geography (Customer) | Country risk score calculated successfully.
2024-09-25 17:06:18 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-09-25 17:06:18 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:06:18 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_01
2024-09-25 17:06:18 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-09-25 17:06:18 - INFO - Fetched 150691 transactions | Total unique customers: 49966
2024-09-25 17:06:18 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:06:18 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 17:06:18 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 17:06:18 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 17:06:18 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 17:06:18 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 17:06:34 - INFO - No Alerts found!
2024-09-25 17:06:34 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 17:06:34 - INFO - No alerts generated!
2024-09-25 17:06:34 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_01
2024-09-25 17:06:34 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-09-25 17:06:35 - INFO - Fetched 149892 transactions | Total unique customers: 74931
2024-09-25 17:06:35 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:06:35 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 17:06:35 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 17:06:35 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 17:06:35 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 17:06:35 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 17:06:53 - INFO - Total alerts found - 1
2024-09-25 17:06:53 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-09-25 17:06:53 - INFO - Generated alert transaction table with 3 rows.
2024-09-25 17:06:53 - INFO - Generated evidence report with 1 rows.
2024-09-25 17:06:53 - INFO - Generated alert customer account mapping table with 1 rows.
2024-09-25 17:06:53 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:06:58 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_01'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-09-25 17:06:58 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-09-25 17:06:58 - INFO - High Risk Geography (Customer) AlertRiskScoring has been initialized.
2024-09-25 17:06:58 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:06:58 - INFO - High Risk Geography (Customer) : calculating Prior Alert Scores.
2024-09-25 17:07:02 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.CUST_ID IN ('B5AEa3DCBC5f0E1')
                    AND TS_ALERT.CREATED_DATE >= '2024-03-25'
                
2024-09-25 17:07:03 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:07:08 - INFO - Successfully executed query: SELECT * FROM TS_COUNTRY
2024-09-25 17:07:09 - INFO - Scenario - High Risk Geography (Customer) | Country risk flags fetched successfully.
2024-09-25 17:07:09 - INFO - Scenario - High Risk Geography (Customer) | Country risk score calculated successfully.
2024-09-25 17:07:16 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-09-25 17:07:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:07:16 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_01
2024-09-25 17:07:16 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-09-25 17:07:16 - INFO - Fetched 155768 transactions | Total unique customers: 99859
2024-09-25 17:07:16 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:07:16 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 17:07:16 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 17:07:16 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 17:07:16 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 17:07:16 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 17:07:33 - INFO - No Alerts found!
2024-09-25 17:07:33 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 17:07:33 - INFO - No alerts generated!
2024-09-25 17:07:33 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_01
2024-09-25 17:07:33 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-09-25 17:07:33 - INFO - Fetched 156005 transactions | Total unique customers: 124753
2024-09-25 17:07:33 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:07:33 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 17:07:33 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 17:07:33 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 17:07:33 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 17:07:33 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 17:07:51 - INFO - No Alerts found!
2024-09-25 17:07:51 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 17:07:51 - INFO - No alerts generated!
2024-09-25 17:07:51 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_01
2024-09-25 17:07:51 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-09-25 17:07:51 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-09-25 17:07:51 - ERROR - No data found for scenario ID TS_SCN_01 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-09-25 17:07:51 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-09-25 17:07:52 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-09-25 17:07:52 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:07:57 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-09-25 17:07:57 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 17:08:02 - ERROR - Job ID - 157 | Error updating job monitor status: (pyodbc.IntegrityError) ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Cannot insert duplicate key row in object 'dbo.TS_JOB_EXEC' with unique index 'UK_gusjc4xe2tmqu4b2ldcbaclxp'. The duplicate key value is (157). (2601) (SQLExecDirectW)")
[SQL: INSERT INTO [TS_JOB_EXEC] ([JOB_NAME], [JOB_TEXT], [EXEC_DATE], [END_TS], [START_TS], [STATUS], [TRIGGERED_BY], [JOB_ID]) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('Unusual Wire Transfer Activity Exceeding (Risk %) and ($ Threshold)', "3 alerts found! | Successful scenarios - ['TS_SCN_01'] | Failed scenarios - []", '2024-09-25', datetime.datetime(2024, 9, 25, 17, 7, 57, 604018), datetime.datetime(2024, 9, 25, 17, 5, 12, 50710), 'SUCCESS', 3, 157)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-09-25 17:08:02 - ERROR - Pipeline execution failed: (pyodbc.IntegrityError) ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Cannot insert duplicate key row in object 'dbo.TS_JOB_EXEC' with unique index 'UK_gusjc4xe2tmqu4b2ldcbaclxp'. The duplicate key value is (157). (2601) (SQLExecDirectW)")
[SQL: INSERT INTO [TS_JOB_EXEC] ([JOB_NAME], [JOB_TEXT], [EXEC_DATE], [END_TS], [START_TS], [STATUS], [TRIGGERED_BY], [JOB_ID]) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('Unusual Wire Transfer Activity Exceeding (Risk %) and ($ Threshold)', "3 alerts found! | Successful scenarios - ['TS_SCN_01'] | Failed scenarios - []", '2024-09-25', datetime.datetime(2024, 9, 25, 17, 7, 57, 604018), datetime.datetime(2024, 9, 25, 17, 5, 12, 50710), 'SUCCESS', 3, 157)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
pyodbc.IntegrityError: ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Cannot insert duplicate key row in object 'dbo.TS_JOB_EXEC' with unique index 'UK_gusjc4xe2tmqu4b2ldcbaclxp'. The duplicate key value is (157). (2601) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/runner.py", line 115, in run_pipeline
    job_updater.update_job_execution_status("SUCCESS", f"{result['total_alerts']} alerts found! | Successful scenarios - {result['successful_scenarios']} | Failed scenarios - {result['failed_scenarios']}", start_time, time.time())
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/job_status_updater.py", line 125, in update_job_execution_status
    raise e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/TS_TRXN_MONITORING_SPARK/ts_pusher/job_status_updater.py", line 119, in update_job_execution_status
    job_data.to_sql(name='TS_JOB_EXEC', con=self.sql_executor.create_engine(), if_exists='append', index=False)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/pandas/io/sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/hackit/Desktop/TM/SCENARIO_SPARK/scenarioenv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (pyodbc.IntegrityError) ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Cannot insert duplicate key row in object 'dbo.TS_JOB_EXEC' with unique index 'UK_gusjc4xe2tmqu4b2ldcbaclxp'. The duplicate key value is (157). (2601) (SQLExecDirectW)")
[SQL: INSERT INTO [TS_JOB_EXEC] ([JOB_NAME], [JOB_TEXT], [EXEC_DATE], [END_TS], [START_TS], [STATUS], [TRIGGERED_BY], [JOB_ID]) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('Unusual Wire Transfer Activity Exceeding (Risk %) and ($ Threshold)', "3 alerts found! | Successful scenarios - ['TS_SCN_01'] | Failed scenarios - []", '2024-09-25', datetime.datetime(2024, 9, 25, 17, 7, 57, 604018), datetime.datetime(2024, 9, 25, 17, 5, 12, 50710), 'SUCCESS', 3, 157)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-09-25 18:16:28 - INFO - Received request to start pipeline with details: {'JOB_ID': 157, 'SCENARIO_IDS': ['TS_SCN_01'], 'TRIGGER_BY': 3, 'IS_MANUAL_JOB': True}
2024-09-25 18:16:28 - INFO - Starting scenario data retrieval.
2024-09-25 18:16:28 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:16:28 - INFO - Fetching scenario configuration data
2024-09-25 18:16:34 - INFO - Successfully executed query: 
        SELECT
            TS_SCENARIO.SCENARIO_ID,
            TS_SCENARIO.SCENARIO_NM,
            TS_SCENARIO.ALERT_TYPE_ID,
            TS_SCENARIO.SCENARIO_FOCUS,
            TS_SCENARIO.SCENARIO_FREQUENCY,
            TS_SCENARIO.STATUS_ID AS SCENARIO_STATUS_ID,
            TS_SCENARIO.THRESHOLD_LEVEL_FL,
            TS_SCN_CONFIG.CONFIG_ID,
            TS_SCN_CONFIG.SQL_TX,
            TS_SCN_CONFIG.CONFIG_TYPE_CD,
            TS_SCN_CONFIG.STATUS_ID AS CONFIG_STATUS_ID,
            SCENARIO_STATUS.STATUS_NAME AS SCENARIO_STATUS_NAME,
            CONFIG_STATUS.STATUS_NAME AS CONFIG_STATUS_NAME,
            THRESHOLD_LEVEL_STATUS.STATUS_NAME AS THRESHOLD_STATUS_NAME
        FROM TS_SCENARIO
        LEFT JOIN TS_SCN_CONFIG ON TS_SCENARIO.SCENARIO_ID = TS_SCN_CONFIG.SCENARIO_ID
        LEFT JOIN TS_STATUS AS SCENARIO_STATUS ON TS_SCENARIO.STATUS_ID = SCENARIO_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS THRESHOLD_LEVEL_STATUS ON TS_SCENARIO.THRESHOLD_LEVEL_FL = THRESHOLD_LEVEL_STATUS.STATUS_ID
        LEFT JOIN TS_STATUS AS CONFIG_STATUS ON TS_SCN_CONFIG.STATUS_ID = CONFIG_STATUS.STATUS_ID
        WHERE TS_SCENARIO.SCENARIO_ID IN ('TS_SCN_01')
        
2024-09-25 18:16:35 - INFO - Successfully executed query: SELECT JOB_NAME FROM TS_JOB_RUN WHERE JOB_ID = 157
2024-09-25 18:16:35 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:16:35 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:16:44 - INFO - Job ID - 157 | Job Monitor Details Status updated to RUNNING
2024-09-25 18:16:44 - INFO - Starting customer ID retrieval.
2024-09-25 18:16:44 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:16:59 - INFO - Successfully executed query: SELECT CUST_ID FROM TS_CUST ORDER BY CUST_ID
2024-09-25 18:16:59 - INFO - Successfully fetched 125001 customer IDs.
2024-09-25 18:16:59 - INFO - Starting threshold data retrieval.
2024-09-25 18:16:59 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:16:59 - INFO - SQLQueryExecutor initialized successfully.
2024-09-25 18:16:59 - INFO - Fetching threshold configuration data.
2024-09-25 18:16:59 - DEBUG - Processing scenario ID: TS_SCN_01
2024-09-25 18:16:59 - DEBUG - Executing SQL query for scenario ID TS_SCN_01: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND IS_ACTIVE = 1
2024-09-25 18:17:02 - INFO - Successfully executed query: 
    SELECT
        TS_THRESHOLD_SET.THRESHOLD_SET_ID,
        TS_THRESHOLD.THRESHOLD_VALUE,
        TS_THRESHOLD_TYPE.DPLY_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_NM,
        TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID,
        TS_THRESHOLD_TYPE.SCENARIO_ID
    FROM TS_THRESHOLD_SET
    JOIN TS_THRESHOLD ON TS_THRESHOLD_SET.THRESHOLD_SET_ID = TS_THRESHOLD.THRESHOLD_SET_ID
    JOIN TS_THRESHOLD_TYPE ON TS_THRESHOLD_TYPE.SCENARIO_ID = TS_THRESHOLD_SET.SCENARIO_ID
    AND TS_THRESHOLD_TYPE.THRESHOLD_TYPE_ID = TS_THRESHOLD.THRESHOLD_TYPE_ID
    WHERE TS_THRESHOLD_TYPE.SCENARIO_ID = 'TS_SCN_01'
     AND IS_ACTIVE = 1
2024-09-25 18:17:03 - INFO - Threshold data fetching completed successfully.
2024-09-25 18:17:03 - INFO - Starting customer ID processing.
2024-09-25 18:17:03 - INFO - Starting Parquet files processing.
2024-09-25 18:17:03 - INFO - Processing up to 6 Parquet files in directory: Parquet_Data/157/
2024-09-25 18:17:03 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_0.parquet
2024-09-25 18:17:03 - INFO - Fetched 303374 transactions | Total unique customers: 24995
2024-09-25 18:17:03 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:17:03 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 18:17:03 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 18:17:03 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 18:17:03 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 18:17:03 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 18:17:24 - INFO - Total alerts found - 2
2024-09-25 18:17:24 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 2
2024-09-25 18:17:24 - INFO - Generated alert transaction table with 6 rows.
2024-09-25 18:17:24 - INFO - Generated evidence report with 2 rows.
2024-09-25 18:17:24 - INFO - Generated alert customer account mapping table with 2 rows.
2024-09-25 18:17:24 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:17:29 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_01'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-09-25 18:17:29 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-09-25 18:17:29 - INFO - High Risk Geography (Customer) AlertRiskScoring has been initialized.
2024-09-25 18:17:29 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:17:29 - INFO - High Risk Geography (Customer) : calculating Prior Alert Scores.
2024-09-25 18:17:34 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.CUST_ID IN ('19Ae0bcab8DAa6A', '18c360a92A58E0f')
                    AND TS_ALERT.CREATED_DATE >= '2024-03-25'
                
2024-09-25 18:17:34 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:17:38 - INFO - Successfully executed query: SELECT * FROM TS_COUNTRY
2024-09-25 18:17:39 - INFO - Scenario - High Risk Geography (Customer) | Country risk flags fetched successfully.
2024-09-25 18:17:39 - INFO - Scenario - High Risk Geography (Customer) | Country risk score calculated successfully.
2024-09-25 18:17:44 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-09-25 18:17:45 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:17:45 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_0.parquet with scenario ID TS_SCN_01
2024-09-25 18:17:45 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_1.parquet
2024-09-25 18:17:45 - INFO - Fetched 150691 transactions | Total unique customers: 49966
2024-09-25 18:17:45 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:17:45 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 18:17:45 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 18:17:45 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 18:17:45 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 18:17:45 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 18:18:03 - INFO - No Alerts found!
2024-09-25 18:18:03 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 18:18:03 - INFO - No alerts generated!
2024-09-25 18:18:03 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_1.parquet with scenario ID TS_SCN_01
2024-09-25 18:18:03 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_2.parquet
2024-09-25 18:18:04 - INFO - Fetched 149892 transactions | Total unique customers: 74931
2024-09-25 18:18:04 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:18:04 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 18:18:04 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 18:18:04 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 18:18:04 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 18:18:04 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 18:18:23 - INFO - Total alerts found - 1
2024-09-25 18:18:23 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 1
2024-09-25 18:18:23 - INFO - Generated alert transaction table with 3 rows.
2024-09-25 18:18:23 - INFO - Generated evidence report with 1 rows.
2024-09-25 18:18:23 - INFO - Generated alert customer account mapping table with 1 rows.
2024-09-25 18:18:23 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:18:27 - INFO - Successfully executed query: 
                SELECT
    A.ATTR_ID,
    A.ATTR_NM,
    S.SCR_GRP_TYPE,
    S.WEIGHTAGE,
    V.MIN_VALUE,
    V.MAX_VALUE,
    V.ATTR_SCORE
FROM
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR] A
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_ATTR_VAL] V ON A.ATTR_ID = V.SCR_ATTR_ID
LEFT JOIN
[TS_STAR].[dbo].[TS_ALERT_SCR_GRP] S ON A.SCR_GRP_ID = S.SCR_GRP_ID

                WHERE
                A.SCENARIO_ID = 'TS_SCN_01'
                AND (A.IS_ACTIVE IS NULL OR A.IS_ACTIVE = 'true');
            
2024-09-25 18:18:28 - INFO - Job ID - 157 | Alert Scoring attributes dictionary created successfully!
2024-09-25 18:18:28 - INFO - High Risk Geography (Customer) AlertRiskScoring has been initialized.
2024-09-25 18:18:28 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:18:28 - INFO - High Risk Geography (Customer) : calculating Prior Alert Scores.
2024-09-25 18:18:32 - INFO - Successfully executed query: 
                    SELECT
    TS_ALERT.ALERT_ID,
    TS_ALERT.ALERT_TX,
    TS_ALERT.PREV_MATCH_CT_ALL,
    TS_ALERT.PREV_MATCH_CT,
    TS_ALERT.SCENARIO_ID,
    UPPER(TS_STATUS.STATUS) AS STATUS_CD,
    --TS_ALERT_CUST
    TS_ALERT_CUST.CUST_ID,
    TS_ALERT_CUST.ACCT_ID,

    TS_ALERT_INVGTN.AUTO_REASN_FL,
    TS_ALERT_CASE.ALERT_INVSTN_ID,
    TS_SAR_CASE.CASE_ID,
    TS_SAR.SAR_ID
FROM
    TS_ALERT
LEFT JOIN
    TS_ALERT_CUST ON TS_ALERT.ALERT_ID = TS_ALERT_CUST.ALERT_ID
LEFT JOIN
    TS_ALERT_INVGTN ON TS_ALERT_INVGTN.ALERT_ID = TS_ALERT.ALERT_ID
LEFT JOIN
    TS_ALERT_CASE ON TS_ALERT_INVGTN.ALERT_INVSTN_ID = TS_ALERT_CASE.ALERT_INVSTN_ID
--JOIN
    --TS_CASE ON TS_ALERT_CASE.CASE_ID = TS_CASE.CASE_ID
LEFT JOIN
    TS_SAR_CASE ON TS_ALERT_CASE.CASE_ID = TS_SAR_CASE.CASE_ID
LEFT JOIN
    TS_SAR ON TS_SAR_CASE.SAR_ID = TS_SAR.SAR_ID
LEFT JOIN
    TS_STATUS ON TS_STATUS.STATUS_ID = TS_ALERT_INVGTN.STATUS_ID
                    WHERE
                    TS_ALERT_CUST.CUST_ID IN ('B5AEa3DCBC5f0E1')
                    AND TS_ALERT.CREATED_DATE >= '2024-03-25'
                
2024-09-25 18:18:33 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:18:37 - INFO - Successfully executed query: SELECT * FROM TS_COUNTRY
2024-09-25 18:18:37 - INFO - Scenario - High Risk Geography (Customer) | Country risk flags fetched successfully.
2024-09-25 18:18:37 - INFO - Scenario - High Risk Geography (Customer) | Country risk score calculated successfully.
2024-09-25 18:18:42 - INFO - Successfully executed query: 
                                    SELECT TS_ALERT_CUST.ALERT_ID, TS_ALERT_CUST.CUST_ID, TS_ALERT_CUST.ACCT_ID , TS_ALERT.SCENARIO_ID
                                    FROM TS_ALERT_CUST
                                    INNER JOIN TS_ALERT ON TS_ALERT_CUST.ALERT_ID = TS_ALERT.ALERT_ID
                                                        
2024-09-25 18:18:43 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:18:43 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_2.parquet with scenario ID TS_SCN_01
2024-09-25 18:18:43 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_3.parquet
2024-09-25 18:18:43 - INFO - Fetched 155768 transactions | Total unique customers: 99859
2024-09-25 18:18:43 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:18:43 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 18:18:43 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 18:18:43 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 18:18:43 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 18:18:43 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 18:19:02 - INFO - No Alerts found!
2024-09-25 18:19:02 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 18:19:02 - INFO - No alerts generated!
2024-09-25 18:19:02 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_3.parquet with scenario ID TS_SCN_01
2024-09-25 18:19:02 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_4.parquet
2024-09-25 18:19:02 - INFO - Fetched 156005 transactions | Total unique customers: 124753
2024-09-25 18:19:02 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:19:02 - INFO - Importing AlertChecker class for scenario_id: TS_SCN_01
2024-09-25 18:19:02 - INFO - ALERTCHECKER initialized successfully.
2024-09-25 18:19:02 - INFO - Initializing AlertChecker for TS_SCN_01
2024-09-25 18:19:02 - INFO - Importing EvidenceReportGenerator class for scenario_id: TS_SCN_01
2024-09-25 18:19:02 - INFO - EvidenceReportGenerator initialized successfully.
2024-09-25 18:19:22 - INFO - No Alerts found!
2024-09-25 18:19:22 - INFO - Successfully processed data with ALERTCHECKER. Total Alert - 0
2024-09-25 18:19:22 - INFO - No alerts generated!
2024-09-25 18:19:22 - INFO - Successfully processed Parquet file Parquet_Data/157/trxn_data_chunk_4.parquet with scenario ID TS_SCN_01
2024-09-25 18:19:22 - INFO - Reading Parquet file: Parquet_Data/157/trxn_data_chunk_5.parquet
2024-09-25 18:19:22 - INFO - Fetched 2 transactions | Total unique customers: 124754
2024-09-25 18:19:22 - ERROR - No data found for scenario ID TS_SCN_01 in Parquet file Parquet_Data/157/trxn_data_chunk_5.parquet after applying scenario config filters.
2024-09-25 18:19:22 - INFO - All data fetched: 915732 transactions | Total unique customers: 124754
2024-09-25 18:19:23 - INFO - Job ID - 157 |  Job Monitor Details Updated Successfully
2024-09-25 18:19:23 - INFO - Creating SQLAlchemy engine for database connection.
2024-09-25 18:19:28 - INFO - Job ID - 157 |  Job Details Updated Successfully
2024-09-25 18:19:28 - INFO - Pipeline execution completed successfully.
